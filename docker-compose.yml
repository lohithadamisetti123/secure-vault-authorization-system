services:
  blockchain:
    image: trufflesuite/ganache:v7.9.0
    container_name: secure-vault-blockchain
    command: 
      - "--host=0.0.0.0"
      - "--port=8545"
      - "--chain.networkId=31337"
      - "--chain.chainId=31337"
      - "--miner.blockTime=1"
    ports:
      - "8545:8545"
    networks:
      - vault-network

  deployer:
    build:
      context: .
      dockerfile: ./docker/Dockerfile
    container_name: secure-vault-deployer
    depends_on:
      - blockchain
    environment:
      - HARDHAT_NETWORK=localhost
    volumes:
      - ./deployments:/app/deployments
    networks:
      - vault-network

networks:
  vault-network:
    driver: bridge
